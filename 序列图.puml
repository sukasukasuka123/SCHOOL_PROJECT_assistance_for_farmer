@startuml
title <size:40><b>果园助农：无人机协同溯源流程</b></size>\n<size:26>从“田间作业”到“餐桌消费”的全链路闭环</size>

' 极致性能与大屏优化
skinparam dpi 250
!pragma maxwidth 40000
skinparam backgroundColor #FAFAFA
skinparam defaultFontSize 28
skinparam defaultFontName Microsoft YaHei
skinparam sequenceMessageAlign center
skinparam maxMessageSize 350

' 强化参与者样式
skinparam participant {
  BackgroundColor #E8F4F8
  BorderColor #2E86AB
  BorderThickness 6
  FontSize 30
  FontStyle bold
}

skinparam actor {
  BackgroundColor #F3E5F5
  BorderColor #7B1FA2
  BorderThickness 6
  FontSize 30
}

skinparam sequence {
  ArrowColor #333333
  ArrowThickness 6
  LifeLineBorderColor #444444
  LifeLineBorderThickness 5
}

actor "侦察机\n(感知)" as Scout
actor "投放机\n(执行)" as Deploy
participant "区块链\n(存证)" as Chain
actor "管理B端\n(果农)" as Farmer
actor "消费C端\n(顾客)" as Buyer

== <size:32>阶段一：智能巡检与精准防治</size> ==

Scout -> Scout : **边缘 AI 识别病害**\n(YOLOv5-Nano实时处理)

Scout -[#D32F2F]> Deploy : **LoRa P2P 调度**\n(精准传输地块坐标)

note over Scout, Deploy #FFEBEE
  <color:red>**紧急预警环**：</color>
  严重度 ≥ 0.8 时触发声光与 App 强力报警
end note

Deploy -> Deploy : **执行精准作业**\n(微量喷洒/生物投放)

Deploy -[#1976D2]> Chain : **作业哈希自动上链**\n(确保数据真实不可篡改)

== <size:32>阶段二：采摘封装与品牌溯源</size> ==

Farmer -[#388E3C]> Chain : **创建采摘批次**\n(HarvestBatchRecord)
note over Farmer, Chain #E8F5E9: 自动关联生长周期内所有防治记录

Buyer -[#1565C0]> Chain : **手机端一码溯源**
Chain --[#1565C0]> Buyer : **生成可视化溯源报告**
note over Buyer #FFF9C4: **核心价值**：品牌溢价提升 20%

@enduml
